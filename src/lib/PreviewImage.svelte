<script lang="ts">
  import { decreaseBodyOpacity } from '$lib/store';
  import { customTransitionIn, customTransitionOut } from './customTransition';
  import { FxParallax as Img } from '@zerodevx/svelte-img';

  export let src: any;
  export let alt: string;
  export let aspect: string;
  export let projectUrl: string;
  export let meta: string[] = [];

  export let imageClasses: string = '';
  export let metaClasses: string = '';

  export let loading: 'eager' | 'lazy' = 'lazy';

  let isTitleVisible = false;

  const onMouseEnter = () => {
    isTitleVisible = true;
    decreaseBodyOpacity.set(isTitleVisible);
  };

  const onMouseOut = () => {
    isTitleVisible = false;
    decreaseBodyOpacity.set(isTitleVisible);
  };
</script>

{#if isTitleVisible}
  <div
    class="fixed inset-0 hidden md:flex items-center justify-center text-6xl uppercase z-40 pointer-events-none serif"
  >
    <div class="overflow-hidden px-3">
      <div
        class="translate-y-full my-9"
        in:customTransitionIn={{ duration: 900 }}
        out:customTransitionOut={{ duration: 400 }}
      >
        {meta[1]}
      </div>
    </div>
  </div>
{/if}

<div class={imageClasses}>
  <a
    class="block mix-blend-color"
    href={projectUrl}
    style={`aspect-ratio: ${aspect}`}
    on:mouseenter={onMouseEnter}
    on:mouseleave={onMouseOut}
  >
    <Img class="h-full w-full hue" {src} factor={0.91} {alt} {loading} />
  </a>
</div>

<div class={`lg:hidden ${metaClasses}`}>
  {#if meta.length}
    {#each meta as line}
      <div>{line}</div>
    {/each}
  {/if}
</div>

<style>
  :global(.hue picture) {
    transition: filter 0.9s;
  }

  :global(.hue:hover picture) {
    filter: grayscale(100%) brightness(1.5);
  }
</style>
